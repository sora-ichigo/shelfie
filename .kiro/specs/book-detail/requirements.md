# Requirements Document

## Introduction
本検索でヒットしたアイテムをタップしたときに遷移する本詳細画面の要件を定義する。この画面は書籍の詳細情報を表示し、本棚への追加・読書記録の管理機能を提供する。書籍が本棚に追加済みかどうかで表示内容が分岐する。

## Requirements

### Requirement 1: 書籍基本情報の表示
**Objective:** ユーザーとして、書籍の詳細情報を確認したい。これにより、本を追加するかどうかを判断できる。

#### Acceptance Criteria
1. When ユーザーが本詳細画面を開いたとき, the モバイルアプリ shall 書籍の表紙画像を画面中央に大きく表示する
2. When ユーザーが本詳細画面を開いたとき, the モバイルアプリ shall 書籍のタイトルと著者名を表示する
3. When ユーザーが本詳細画面を開いたとき, the モバイルアプリ shall 書誌情報セクションに出版社、発売日、ページ数、ジャンル（タグ形式）、ISBNを表示する
4. When ユーザーが本詳細画面を開いたとき, the モバイルアプリ shall 作品紹介セクションに書籍の説明文を表示する
5. If 書籍情報の一部が存在しない場合, the モバイルアプリ shall 該当フィールドを非表示にするか、プレースホルダーを表示する

### Requirement 2: 画面ナビゲーション
**Objective:** ユーザーとして、本詳細画面から前の画面に戻ったり、情報を共有したい。これにより、スムーズな画面遷移と情報共有ができる。

#### Acceptance Criteria
1. The モバイルアプリ shall 画面上部に閉じるボタン（×）を表示する
2. When ユーザーが閉じるボタンをタップしたとき, the モバイルアプリ shall 前の画面に戻る
3. The モバイルアプリ shall 画面上部に共有ボタンを表示する
4. When ユーザーが共有ボタンをタップしたとき, the モバイルアプリ shall OS標準の共有シートを表示する

### Requirement 3: 本棚への追加（未追加状態）
**Objective:** ユーザーとして、気に入った本を本棚に追加したい。これにより、後で読書記録を管理できる。

#### Acceptance Criteria
1. While 書籍が本棚に未追加の状態で, the モバイルアプリ shall 「+ 本棚に追加」ボタンを目立つ位置に表示する
2. When ユーザーが「本棚に追加」ボタンをタップしたとき, the モバイルアプリ shall 書籍を本棚に追加する
3. When 書籍の追加が成功したとき, the モバイルアプリ shall 画面を追加済み状態の表示に更新する
4. If 書籍の追加に失敗した場合, the モバイルアプリ shall エラーメッセージを表示する

### Requirement 4: 読書記録の表示（追加済み状態）
**Objective:** ユーザーとして、追加済みの書籍の読書状態を確認したい。これにより、読書の進捗を把握できる。

#### Acceptance Criteria
1. While 書籍が本棚に追加済みの状態で, the モバイルアプリ shall 読書記録セクションを表示する
2. While 書籍が本棚に追加済みの状態で, the モバイルアプリ shall 現在の読書状態（積読/読書中/読了/読まない）を表示する
3. While 書籍が本棚に追加済みの状態で, the モバイルアプリ shall 追加日を表示する
4. While 読書状態が「読了」の場合, the モバイルアプリ shall 読了日を表示する
5. While 書籍が本棚に追加済みの状態で, the モバイルアプリ shall 読書メモセクションを表示する
6. While 読書メモが存在する場合, the モバイルアプリ shall 最終更新日時を表示する

### Requirement 5: 読書状態の編集
**Objective:** ユーザーとして、読書状態を変更したい。これにより、読書の進捗に合わせて記録を更新できる。

#### Acceptance Criteria
1. When ユーザーが読書状態フィールドをタップしたとき, the モバイルアプリ shall 画面下部から編集モーダルをスライドアップ表示する
2. The モバイルアプリ shall 読書状態の選択肢として「積読」「読書中」「読了」「読まない」の4つを表示する
3. When ユーザーが読書状態を選択して保存ボタンをタップしたとき, the モバイルアプリ shall 読書状態を更新する
4. When 読書状態の更新が成功したとき, the モバイルアプリ shall モーダルを閉じて画面を更新する
5. When ユーザーがキャンセルボタンをタップしたとき, the モバイルアプリ shall 変更を破棄してモーダルを閉じる
6. If 読書状態の更新に失敗した場合, the モバイルアプリ shall エラーメッセージを表示する

### Requirement 6: 読書メモの編集
**Objective:** ユーザーとして、読書メモを記録・編集したい。これにより、読書の感想や気づきを残すことができる。

#### Acceptance Criteria
1. When ユーザーが読書メモセクションをタップしたとき, the モバイルアプリ shall 画面下部から編集モーダルをスライドアップ表示する
2. The モバイルアプリ shall モーダル内にテキストエリアを表示する
3. While モーダルが表示されている状態で, the モバイルアプリ shall キャンセルボタンと保存ボタンを表示する
4. When ユーザーがメモを入力して保存ボタンをタップしたとき, the モバイルアプリ shall 読書メモを更新する
5. When 読書メモの更新が成功したとき, the モバイルアプリ shall モーダルを閉じて画面を更新し、最終更新日時を反映する
6. When ユーザーがキャンセルボタンをタップしたとき, the モバイルアプリ shall 変更を破棄してモーダルを閉じる
7. If 読書メモの更新に失敗した場合, the モバイルアプリ shall エラーメッセージを表示する

### Requirement 7: 外部リンク
**Objective:** ユーザーとして、書籍を購入したり詳細情報を確認したい。これにより、興味のある本を入手できる。

#### Acceptance Criteria
1. The モバイルアプリ shall 購入・詳細セクションに「Amazonで見る」リンクを表示する
2. Where 公式サイト情報が存在する場合, the モバイルアプリ shall 「公式サイトへ」リンクを表示する
3. When ユーザーが外部リンクをタップしたとき, the モバイルアプリ shall 外部ブラウザまたはアプリ内WebViewで該当URLを開く
