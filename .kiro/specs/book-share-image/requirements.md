# Requirements Document

## Introduction

読了した本の画像シェア機能の要件を定義する。Phase 1 の Go-to-Market 戦略として、読了時に「読了カード」を画像として生成し、SNS にシェアすることでオーガニックな認知拡大を図る。ユーザーの「この本よかった」という自己表現欲求を満たしつつ、Shelfie のブランド認知を広げることが目的である。

### 設計原則

- **摩擦を最小化する** — シェアまでのステップを最小にし、デフォルトで即シェアできる状態を作る（Duolingo の「美しいスタットカードを提供することは、ユーザーへの好意である」哲学に倣う）
- **プログレッシブにリッチ化する** — 全情報を1枚に詰め込まず、デフォルトはシンプルなカードを即表示し、ユーザーのデータ状態に応じてリッチなカードに切り替えられる設計とする
- **ユーザーがかっこよく見える** — シェアするのはアプリのためではなく、ユーザー自身の自己表現のため

## Requirements

### Requirement 1: シェア導線

**Objective:** ユーザーとして、読了した本をシェアしたいときに自然な導線でシェア機能にアクセスしたい。読了直後が最もシェア動機が高い瞬間であるため、そのタイミングを逃さない導線が必要である。

#### Acceptance Criteria

1. When ユーザーが書籍詳細画面で読書状態を「読了」に変更する, the アプリ shall シェアを促すアクション（シェアボタンやモーダル等）を表示する
2. While 書籍の読書状態が「読了」である, the 書籍詳細画面 shall シェア画像を生成できるアクションを表示する
3. While 書籍の読書状態が「読了」でない, the 書籍詳細画面 shall シェアアクションを表示しない

### Requirement 2: 読了カード画像の生成（プログレッシブデザイン）

**Objective:** ユーザーとして、読了した本の情報を見栄えのよい「読了カード」画像として生成したい。デフォルトはシンプルなカードを即表示し、評価や感想が入力済みの場合はよりリッチなカードに切り替えられるようにしたい。

#### カードの3段階

| レベル | 名称 | 含む情報 | 表示条件 |
|---|---|---|---|
| デフォルト | **シンプル** | 表紙 + タイトル + 著者名 + Shelfie ロゴ | 常に表示（全ユーザー） |
| オプション1 | **プロフィール付き** | シンプル + ユーザーアイコン + 星評価 + 読了日 | 星評価が設定済みの場合に切り替え可能 |
| オプション2 | **感想共有** | プロフィール付き + 読書メモ（一言感想） | 読書メモが設定済みの場合に切り替え可能 |

#### Acceptance Criteria

1. When ユーザーがシェアアクションを実行する, the アプリ shall デフォルトとしてシンプルカード（表紙画像、タイトル、著者名、Shelfie ロゴ）を即座に生成・表示する
2. When シンプルカードが表示されている and 書籍に星評価が設定されている, the アプリ shall プロフィール付きカード（ユーザーアイコン、星評価、読了日を追加）に切り替えるオプションを提供する
3. When シンプルカードまたはプロフィール付きカードが表示されている and 書籍に読書メモが設定されている, the アプリ shall 感想共有カード（読書メモを追加）に切り替えるオプションを提供する
4. When 書籍に星評価が設定されていない, the アプリ shall プロフィール付きカードへの切り替えオプションを表示しない
5. When 書籍に読書メモが設定されていない, the アプリ shall 感想共有カードへの切り替えオプションを表示しない
6. The すべてのカードレベル shall Shelfie のロゴまたはブランド要素を含む
7. When 書籍に表紙画像が存在しない, the アプリ shall 表紙画像の代わりにプレースホルダーを使用してカード画像を生成する

### Requirement 3: 画像のプレビューと切り替え

**Objective:** ユーザーとして、生成された読了カード画像をシェアする前にプレビューで確認し、必要に応じてカードのレベルを切り替えたい。

#### Acceptance Criteria

1. When 読了カード画像が生成される, the アプリ shall シェア実行前に画像のプレビューを表示する
2. While プレビュー画面が表示されている, the アプリ shall シェアを実行するアクション、画像を保存するアクション、およびキャンセルして戻るアクションを提供する
3. While プレビュー画面が表示されている and 上位レベルのカードが利用可能な場合, the アプリ shall カードレベルの切り替え UI を表示する
4. When ユーザーがカードレベルを切り替える, the アプリ shall プレビュー画像を即座に更新する

### Requirement 4: SNS シェア

**Objective:** ユーザーとして、生成した読了カード画像を X や Instagram Stories などの SNS に直接シェアしたい。シェア先の選択が簡単で、少ないステップで投稿できることが重要である。

#### Acceptance Criteria

1. When ユーザーがシェアを実行する, the アプリ shall OS のシェアシート（共有メニュー）を表示し、ユーザーが任意のアプリにシェアできるようにする
2. The 読了カード画像 shall SNS プラットフォームに適した画像形式（PNG）で生成される
3. The 読了カード画像 shall 主要 SNS プラットフォームに適したアスペクト比で生成される（Instagram Stories: 9:16、Instagram 投稿 / X: 1:1 等はデザインフェーズで決定）
4. If シェア処理中にエラーが発生した場合, the アプリ shall ユーザーにエラーメッセージを表示し、再試行できるようにする

### Requirement 5: 画像の保存

**Objective:** ユーザーとして、生成した読了カード画像を端末に保存したい。SNS に直接シェアするだけでなく、後から別の用途に使いたい場合がある。

#### Acceptance Criteria

1. While プレビュー画面が表示されている, the アプリ shall 画像を端末のフォトライブラリに保存するアクションを提供する
2. When ユーザーが画像保存を実行する and フォトライブラリへのアクセス権限がない, the アプリ shall 権限の許可を求めるダイアログを表示する
3. If 画像の保存に失敗した場合, the アプリ shall ユーザーにエラーメッセージを表示する
4. When 画像の保存が成功した, the アプリ shall 保存完了をユーザーに通知する

## Competitive Research Summary

### 国内読書アプリの現状

読書メーター・ブクログともに画像シェアカード機能はほぼ存在しない（テキスト + リンクベースのシェアのみ）。この領域は明確な差別化ポイントとなる。

### 参考サービスからの学び

| サービス | 学び |
|---|---|
| **Duolingo** | ユーザーがスクショを撮る場所を計測 → そこにシェア機能配置でオーガニックシェア率 5-10 倍増。「ユーザーがかっこよく見えるからシェアする」哲学 |
| **Spotify** | アルバムアートを視覚的中心に。ブランドカラーは控えめだが確実に認識される配置 |
| **Strava / NRC** | 完了直後に即座にサマリーカード表示。摩擦ゼロのシェア体験 |
| **StoryGraph** | IG Stories (9:16) と IG 投稿 (1:1) の2種類を用意。年次 / 月次まとめカードも提供 |
| **Goodreads** | 年次まとめ中心。個別読了のシェアカード生成は弱く、サードパーティツールが補完している状態 |

### 詳細リサーチ

競合・参考サービスの詳細な調査結果は `.kiro/specs/book-share-image/research.md` を参照（※作成予定）。
