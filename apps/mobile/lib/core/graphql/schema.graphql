"""Input for adding a book to the shelf"""
input AddBookInput {
  """The authors of the book"""
  authors: [String!]!

  """The cover image URL of the book"""
  coverImageUrl: String

  """The external ID of the book"""
  externalId: String!

  """The ISBN of the book"""
  isbn: String

  """The publication date of the book"""
  publishedDate: String

  """The publisher of the book"""
  publisher: String

  """The initial reading status of the book (defaults to backlog)"""
  readingStatus: ReadingStatus

  """The source of the book data (rakuten or google)"""
  source: BookSource!

  """The title of the book"""
  title: String!
}

"""Error object for authentication operations"""
type AuthError {
  """Error code"""
  code: AuthErrorCode

  """Field that caused the error, if applicable"""
  field: String

  """Human-readable error message"""
  message: String

  """Whether the operation can be retried"""
  retryable: Boolean
}

"""Error codes for authentication operations"""
enum AuthErrorCode {
  EMAIL_ALREADY_EXISTS
  INTERNAL_ERROR
  INVALID_CREDENTIALS
  INVALID_EMAIL
  INVALID_PASSWORD
  INVALID_TOKEN
  NETWORK_ERROR
  TOKEN_EXPIRED
  UNAUTHENTICATED
  USER_NOT_FOUND
  WEAK_PASSWORD
}

"""Error object for query results"""
type AuthErrorResult {
  """Error code"""
  code: AuthErrorCode

  """Field that caused the error, if applicable"""
  field: String

  """Human-readable error message"""
  message: String

  """Whether the operation can be retried"""
  retryable: Boolean
}

"""An in-app notification"""
type AppNotification {
  """When the notification was created"""
  createdAt: DateTime!

  """The unique identifier of the notification"""
  id: Int!

  """Whether the notification has been read"""
  isRead: Boolean!

  """The user who triggered the notification"""
  sender: User!

  """The type of notification"""
  type: NotificationType!
}

"""A book from the search results"""
type Book {
  """The authors of the book"""
  authors: [String!]!

  """The cover image URL of the book"""
  coverImageUrl: String

  """The unique identifier of the book"""
  id: String!

  """The ISBN of the book"""
  isbn: String

  """The publication date of the book"""
  publishedDate: String

  """The publisher of the book"""
  publisher: String

  """The source of the book data (rakuten or google)"""
  source: BookSource!

  """The title of the book"""
  title: String!
}

"""Detailed information about a book"""
type BookDetail {
  """The Amazon URL for the book"""
  amazonUrl: String

  """The authors of the book"""
  authors: [String!]!

  """The categories/genres of the book"""
  categories: [String!]

  """The cover image URL of the book"""
  coverImageUrl: String

  """The description of the book"""
  description: String

  """The Google Books URL for the book (deprecated, use rakutenBooksUrl)"""
  googleBooksUrl: String @deprecated(reason: "Use rakutenBooksUrl instead")

  """The unique identifier of the book"""
  id: String!

  """The ISBN of the book"""
  isbn: String

  """The number of pages in the book"""
  pageCount: Int

  """The publication date of the book"""
  publishedDate: String

  """The publisher of the book"""
  publisher: String

  """The Rakuten Books URL for the book"""
  rakutenBooksUrl: String

  """The title of the book"""
  title: String!

  """The user's reading record for this book (if added to shelf)"""
  userBook: UserBook
}

"""A book list created by a user"""
type BookList {
  """When the book list was created"""
  createdAt: DateTime!

  """The description of the book list"""
  description: String

  """The unique identifier of the book list"""
  id: Int!

  """The title of the book list"""
  title: String!

  """When the book list was last updated"""
  updatedAt: DateTime!
}

"""Detailed information about a book list including items"""
type BookListDetail {
  """When the book list was created"""
  createdAt: DateTime!

  """The description of the book list"""
  description: String

  """The unique identifier of the book list"""
  id: Int!

  """The items in the book list"""
  items: [BookListDetailItem!]!

  """Statistics for the book list"""
  stats: BookListDetailStats!

  """The title of the book list"""
  title: String!

  """When the book list was last updated"""
  updatedAt: DateTime!
}

"""An item in a book list with user book details"""
type BookListDetailItem {
  """When the book was added to the list"""
  addedAt: DateTime!

  """The unique identifier of the book list item"""
  id: Int!

  """The position of the item in the list"""
  position: Int!

  """The user book details (loaded on demand)"""
  userBook: BookListDetailUserBook
}

"""Statistics for a book list"""
type BookListDetailStats {
  """Total number of books in the list"""
  bookCount: Int!

  """Number of completed books in the list"""
  completedCount: Int!

  """Cover images of books in the list (up to 4)"""
  coverImages: [String!]!
}

"""User book information in a book list detail"""
type BookListDetailUserBook {
  """The authors of the book"""
  authors: [String!]!

  """The cover image URL of the book"""
  coverImageUrl: String

  """The external ID of the book (Google Books or Rakuten)"""
  externalId: String!

  """The unique identifier of the user book"""
  id: Int!

  """The reading status of the book"""
  readingStatus: String!

  """The source of the book (google or rakuten)"""
  source: String!

  """The title of the book"""
  title: String!
}

"""Summary information about a book list"""
type BookListSummary {
  """The number of books in the list"""
  bookCount: Int!

  """Cover images of books in the list (up to 4)"""
  coverImages: [String!]!

  """When the book list was created"""
  createdAt: DateTime!

  """The description of the book list"""
  description: String

  """The unique identifier of the book list"""
  id: Int!

  """The title of the book list"""
  title: String!

  """When the book list was last updated"""
  updatedAt: DateTime!
}

"""Source of the book data"""
enum BookSource {
  """Google Books API"""
  GOOGLE

  """Rakuten Books API"""
  RAKUTEN
}

"""Input for password change"""
input ChangePasswordInput {
  """Current password"""
  currentPassword: String!

  """User email address"""
  email: String!

  """New password"""
  newPassword: String!
}

"""Result of successful password change"""
type ChangePasswordResult {
  """New Firebase ID token"""
  idToken: String!

  """New refresh token"""
  refreshToken: String!
}

"""Input for creating a new book list"""
input CreateBookListInput {
  """The description of the book list"""
  description: String

  """The title of the book list"""
  title: String!
}

"""
A date-time string at UTC, such as 2007-12-03T10:15:30Z, compliant with the `date-time` format outlined in section 5.6 of the RFC 3339 profile of the ISO 8601 standard for representation of dates and times using the Gregorian calendar.
"""
scalar DateTime

"""Follow counts for a user"""
type FollowCounts {
  """Number of followers"""
  followerCount: Int!

  """Number of users being followed"""
  followingCount: Int!
}

"""A follow request between users"""
type FollowRequest {
  """When the request was created"""
  createdAt: DateTime!

  """The unique identifier of the follow request"""
  id: Int!

  """The user who received the request"""
  receiverId: Int!

  """The user who sent the request"""
  senderId: Int!

  """The current status of the request"""
  status: FollowRequestStatus!
}

"""Status of a follow request"""
enum FollowRequestStatus {
  APPROVED
  PENDING
  REJECTED
}

"""Follow relationship status between two users"""
enum FollowStatus {
  FOLLOWING
  NONE
  PENDING_RECEIVED
  PENDING_SENT
}

"""Result of account deletion"""
type DeleteAccountResult {
  """Whether the account was deleted successfully"""
  success: Boolean
}

"""A device token for push notifications"""
type DeviceToken {
  """When the device token was registered"""
  createdAt: DateTime

  """The unique identifier of the device token"""
  id: Int

  """The platform of the device (ios or android)"""
  platform: String

  """The user who owns this device token"""
  userId: Int
}

"""画像アップロードサービスのエラー"""
type ImageUploadError {
  """エラーコード"""
  code: String

  """エラーメッセージ"""
  message: String
}

"""Result of successful login"""
type LoginResult {
  """Firebase ID token for API authentication"""
  idToken: String!

  """Firebase refresh token for obtaining new ID tokens"""
  refreshToken: String!

  """Logged in user"""
  user: User!
}

"""Input for user login"""
input LoginUserInput {
  """Email address"""
  email: String!

  """Password"""
  password: String!
}

"""Result of me query - either User or AuthErrorResult"""
union MeResult = AuthErrorResult | User

union MutationApproveFollowRequestResult = MutationApproveFollowRequestSuccess | ValidationError

type MutationApproveFollowRequestSuccess {
  data: FollowRequest!
}

type Mutation {
  """Add a book to a book list"""
  addBookToList(listId: Int!, userBookId: Int!): BookListDetailItem!

  """Approve a follow request"""
  approveFollowRequest(requestId: Int!): MutationApproveFollowRequestResult

  """Add a book to the user's shelf"""
  addBookToShelf(bookInput: AddBookInput!): UserBook!

  """Change user password after verifying current password"""
  changePassword(input: ChangePasswordInput!): MutationChangePasswordResult

  """Create a new book list"""
  createBookList(input: CreateBookListInput!): BookList!

  """Delete the currently authenticated user's account"""
  deleteAccount: MutationDeleteAccountResult

  """Delete a book list"""
  deleteBookList(listId: Int!): Boolean!

  """Login with email and password"""
  loginUser(input: LoginUserInput!): MutationLoginUserResult

  """Mark all notifications as read"""
  markNotificationsAsRead: Boolean

  """Refresh ID token using refresh token"""
  refreshToken(input: RefreshTokenInput!): MutationRefreshTokenResult

  """Register a device token for push notifications"""
  registerDeviceToken(input: RegisterDeviceTokenInput!): DeviceToken

  """Reject a follow request"""
  rejectFollowRequest(requestId: Int!): MutationRejectFollowRequestResult

  """Register a new user with email and password"""
  registerUser(input: RegisterUserInput!): MutationRegisterUserResult

  """Remove a book from a book list"""
  removeBookFromList(listId: Int!, userBookId: Int!): Boolean!

  """Remove a book from the user's shelf"""
  removeFromShelf(userBookId: Int!): Boolean!

  """Reorder a book within a book list"""
  reorderBookInList(itemId: Int!, listId: Int!, newPosition: Int!): Boolean!

  """Send a follow request to another user"""
  sendFollowRequest(receiverId: Int!): MutationSendFollowRequestResult

  """Send password reset email to the specified address"""
  sendPasswordResetEmail(input: SendPasswordResetEmailInput!): MutationSendPasswordResetEmailResult

  """Unfollow a user"""
  unfollow(targetUserId: Int!): MutationUnfollowResult

  """Unregister a device token"""
  unregisterDeviceToken(input: UnregisterDeviceTokenInput!): Boolean

  """Update an existing book list"""
  updateBookList(input: UpdateBookListInput!): BookList!

  """Update the rating of a book in the user's shelf"""
  updateBookRating(rating: Int, userBookId: Int!): UserBook!

  """Update the completion date of a book in the user's shelf"""
  updateCompletedAt(completedAt: DateTime!, userBookId: Int!): UserBook!

  """Update the current user's profile"""
  updateProfile(input: UpdateProfileInput!): MutationUpdateProfileResult

  """Update the reading note of a book in the user's shelf"""
  updateReadingNote(note: String!, userBookId: Int!): UserBook!

  """Update the thoughts of a book in the user's shelf"""
  updateThoughts(thoughts: String!, userBookId: Int!): UserBook!

  """Update the reading status of a book in the user's shelf"""
  updateReadingStatus(status: ReadingStatus!, userBookId: Int!): UserBook!

  """Update the start date of a book in the user's shelf"""
  updateStartedAt(startedAt: DateTime!, userBookId: Int!): UserBook!
}

union MutationChangePasswordResult = AuthError | MutationChangePasswordSuccess

type MutationChangePasswordSuccess {
  data: ChangePasswordResult!
}

union MutationDeleteAccountResult = AuthError | MutationDeleteAccountSuccess

type MutationDeleteAccountSuccess {
  data: DeleteAccountResult!
}

union MutationLoginUserResult = AuthError | MutationLoginUserSuccess

type MutationLoginUserSuccess {
  data: LoginResult!
}

union MutationRefreshTokenResult = AuthError | MutationRefreshTokenSuccess

type MutationRefreshTokenSuccess {
  data: RefreshTokenResult!
}

union MutationRejectFollowRequestResult = MutationRejectFollowRequestSuccess | ValidationError

type MutationRejectFollowRequestSuccess {
  data: FollowRequest!
}

union MutationRegisterUserResult = AuthError | MutationRegisterUserSuccess

type MutationRegisterUserSuccess {
  data: LoginResult!
}

union MutationSendFollowRequestResult = MutationSendFollowRequestSuccess | ValidationError

type MutationSendFollowRequestSuccess {
  data: FollowRequest!
}

union MutationSendPasswordResetEmailResult = AuthError | MutationSendPasswordResetEmailSuccess

type MutationSendPasswordResetEmailSuccess {
  data: SendPasswordResetEmailResult!
}

union MutationUpdateProfileResult = MutationUpdateProfileSuccess | ValidationError

union MutationUnfollowResult = MutationUnfollowSuccess | ValidationError

type MutationUnfollowSuccess {
  data: Boolean!
}

type MutationUpdateProfileSuccess {
  data: User!
}

"""Type of notification"""
enum NotificationType {
  FOLLOW_REQUEST_APPROVED
  FOLLOW_REQUEST_RECEIVED
}

"""Input for querying user's book lists with pagination"""
input MyBookListsInput {
  """Number of items to return (default: 20)"""
  limit: Int

  """Number of items to skip (default: 0)"""
  offset: Int
}

"""Result of user's book lists query with pagination info"""
type MyBookListsResult {
  """Whether there are more book lists to fetch"""
  hasMore: Boolean!

  """List of book list summaries"""
  items: [BookListSummary!]!

  """Total number of book lists"""
  totalCount: Int!
}

"""Input for querying user's book shelf"""
input MyShelfInput {
  """Number of items to return (default: 20)"""
  limit: Int

  """Number of items to skip (default: 0)"""
  offset: Int

  """Search query to filter books by title or author"""
  query: String

  """Filter books by reading status"""
  readingStatus: ReadingStatus

  """Field to sort by"""
  sortBy: ShelfSortField

  """Sort order direction"""
  sortOrder: SortOrder
}

"""Result of user's book shelf query"""
type MyShelfResult {
  """Whether there are more books to fetch"""
  hasMore: Boolean!

  """List of books in the shelf"""
  items: [UserBook!]!

  """Total number of books matching the query"""
  totalCount: Int!
}

type Query {
  """Get detailed information about a book by ID"""
  bookDetail(
    bookId: String!

    """The source of the book (rakuten or google)"""
    source: BookSource!
  ): BookDetail!

  """Get detailed information about a specific book list"""
  bookListDetail(listId: Int!): BookListDetail!

  """Get follow counts for a user"""
  followCounts(userId: Int!): FollowCounts!

  """Get followers of a user"""
  followers(cursor: Int, limit: Int, userId: Int!): [User!]!

  """Get users that a user is following"""
  following(cursor: Int, limit: Int, userId: Int!): [User!]!

  """署名付きアップロードパラメータを取得"""
  getUploadCredentials: QueryGetUploadCredentialsResult
  health: String

  """Get the currently authenticated user"""
  me: MeResult!

  """Get all book lists created by the authenticated user"""
  myBookLists(input: MyBookListsInput): MyBookListsResult!

  """Get books in the user's shelf with pagination, sorting, and search"""
  myShelf(input: MyShelfInput): MyShelfResult!

  """Get notifications for the current user"""
  notifications(cursor: Int, limit: Int): [AppNotification!]!

  """Get count of pending follow requests"""
  pendingFollowRequestCount: Int!

  """Get pending follow requests for the current user"""
  pendingFollowRequests(cursor: Int, limit: Int): [FollowRequest!]!

  """Search for a book by ISBN"""
  searchBookByISBN(isbn: String!): Book

  """Search for books by keyword (matches title, author, etc.)"""
  searchBooks(limit: Int, offset: Int, query: String!): SearchBooksResult!

  """Get count of unread notifications"""
  unreadNotificationCount: Int!

  """Get the user's reading record for a book by external ID"""
  userBookByExternalId(externalId: String!): UserBook

  """Get a user's profile by handle"""
  userProfile(handle: String!): UserProfile
}

union QueryGetUploadCredentialsResult = ImageUploadError | QueryGetUploadCredentialsSuccess

type QueryGetUploadCredentialsSuccess {
  data: UploadCredentials!
}

"""Reading status of a book in the user's shelf"""
enum ReadingStatus {
  """Unread (backlog)"""
  BACKLOG

  """Finished reading"""
  COMPLETED
  DROP @deprecated(reason: "Use INTERESTED instead. DROP is ignored.")

  """Interested in reading"""
  INTERESTED

  """Currently reading"""
  READING
}

"""Input for token refresh"""
input RefreshTokenInput {
  """Refresh token"""
  refreshToken: String!
}

"""Result of successful token refresh"""
type RefreshTokenResult {
  """New Firebase ID token"""
  idToken: String!

  """New refresh token"""
  refreshToken: String!
}

"""Input for registering a device token"""
input RegisterDeviceTokenInput {
  """Device platform (ios or android)"""
  platform: String!

  """FCM device token"""
  token: String!
}

"""Input for user registration"""
input RegisterUserInput {
  """Email address"""
  email: String!

  """Password"""
  password: String!
}

"""Search results containing a list of books"""
type SearchBooksResult {
  """Whether there are more books to fetch"""
  hasMore: Boolean!

  """The list of books found"""
  items: [Book!]!

  """The total number of books found"""
  totalCount: Int!
}

"""Input for password reset email"""
input SendPasswordResetEmailInput {
  """Email address to send reset link"""
  email: String!
}

"""Result of password reset email request"""
type SendPasswordResetEmailResult {
  """Whether the email was sent successfully"""
  success: Boolean
}

"""Sort field for books in shelf"""
enum ShelfSortField {
  """Sort by date added to shelf"""
  ADDED_AT

  """Sort by author name"""
  AUTHOR

  """Sort by completion date"""
  COMPLETED_AT

  """Sort by publication date"""
  PUBLISHED_DATE

  """Sort by rating"""
  RATING

  """Sort by book title"""
  TITLE
}

"""Sort order direction"""
enum SortOrder {
  """Ascending order"""
  ASC

  """Descending order"""
  DESC
}

"""Input for unregistering a device token"""
input UnregisterDeviceTokenInput {
  """FCM device token"""
  token: String!
}

"""Input for updating an existing book list"""
input UpdateBookListInput {
  """The new description of the book list"""
  description: String

  """The ID of the book list to update"""
  listId: Int!

  """The new title of the book list"""
  title: String
}

"""Input for updating user profile"""
input UpdateProfileInput {
  """User avatar image URL"""
  avatarUrl: String

  """User bio text"""
  bio: String

  """User unique handle"""
  handle: String

  """User Instagram handle"""
  instagramHandle: String

  """User display name"""
  name: String!
}

"""署名付きアップロードパラメータ"""
type UploadCredentials {
  """有効期限（Unix timestamp）"""
  expire: Int

  """ImageKit Public Key"""
  publicKey: String

  """HMAC-SHA1署名"""
  signature: String

  """一意のアップロードトークン"""
  token: String

  """アップロードエンドポイントURL"""
  uploadEndpoint: String
}

"""A user in the system"""
type User {
  """The URL of the user's avatar image (128x128)"""
  avatarUrl: String

  """The user's bio"""
  bio: String

  """The number of books in the user's shelf"""
  bookCount: Int!

  """When the user was created"""
  createdAt: DateTime

  """The email address of the user"""
  email: String

  """The unique identifier of the user"""
  id: Int

  """The user's unique handle"""
  handle: String

  """The user's Instagram handle"""
  instagramHandle: String

  """The display name of the user"""
  name: String

  """When the user was last updated"""
  updatedAt: DateTime
}

"""A book in the user's shelf"""
type UserBook {
  """When the book was added to the shelf"""
  addedAt: DateTime!

  """The authors of the book"""
  authors: [String!]!

  """When the book was marked as completed"""
  completedAt: DateTime

  """The cover image URL of the book"""
  coverImageUrl: String

  """The external ID of the book"""
  externalId: String!

  """The unique identifier of the user book"""
  id: Int!

  """The ISBN of the book"""
  isbn: String

  """User's reading note for the book"""
  note: String

  """When the note was last updated"""
  noteUpdatedAt: DateTime

  """The publication date of the book"""
  publishedDate: String

  """The publisher of the book"""
  publisher: String

  """User's rating for the book (1-5)"""
  rating: Int

  """The reading status of the book"""
  readingStatus: ReadingStatus!

  """The source of the book data (rakuten or google)"""
  source: BookSource!

  """When the book was started reading"""
  startedAt: DateTime

  """User's thoughts/review for the book"""
  thoughts: String

  """When the thoughts were last updated"""
  thoughtsUpdatedAt: DateTime

  """The title of the book"""
  title: String!
}

"""A user's profile with follow information"""
type UserProfile {
  """Follow counts for this user"""
  followCounts: FollowCounts!

  """Follow status between the current user and this user"""
  followStatus: FollowStatus!

  """Whether this is the current user's own profile"""
  isOwnProfile: Boolean!

  """The user"""
  user: User!
}

"""Validation error for user input"""
type ValidationError {
  """Error code"""
  code: String

  """Field that caused the error, if applicable"""
  field: String

  """Human-readable error message"""
  message: String
}