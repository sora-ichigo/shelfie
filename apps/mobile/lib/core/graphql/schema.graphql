"""Input for adding a book to the shelf"""
input AddBookInput {
  """The authors of the book"""
  authors: [String!]!

  """The cover image URL of the book"""
  coverImageUrl: String

  """The external ID of the book"""
  externalId: String!

  """The ISBN of the book"""
  isbn: String

  """The publication date of the book"""
  publishedDate: String

  """The publisher of the book"""
  publisher: String

  """The title of the book"""
  title: String!
}

"""Error object for authentication operations"""
type AuthError {
  """Error code"""
  code: AuthErrorCode

  """Field that caused the error, if applicable"""
  field: String

  """Human-readable error message"""
  message: String

  """Whether the operation can be retried"""
  retryable: Boolean
}

"""Error codes for authentication operations"""
enum AuthErrorCode {
  EMAIL_ALREADY_EXISTS
  INTERNAL_ERROR
  INVALID_CREDENTIALS
  INVALID_PASSWORD
  INVALID_TOKEN
  NETWORK_ERROR
  TOKEN_EXPIRED
  UNAUTHENTICATED
  USER_NOT_FOUND
}

"""Error object for query results"""
type AuthErrorResult {
  """Error code"""
  code: AuthErrorCode

  """Field that caused the error, if applicable"""
  field: String

  """Human-readable error message"""
  message: String

  """Whether the operation can be retried"""
  retryable: Boolean
}

"""A book from the search results"""
type Book {
  """The authors of the book"""
  authors: [String!]!

  """The cover image URL of the book"""
  coverImageUrl: String

  """The unique identifier of the book"""
  id: String!

  """The ISBN of the book"""
  isbn: String

  """The publication date of the book"""
  publishedDate: String

  """The publisher of the book"""
  publisher: String

  """The title of the book"""
  title: String!
}

"""Detailed information about a book"""
type BookDetail {
  """The Amazon URL for the book"""
  amazonUrl: String

  """The authors of the book"""
  authors: [String!]!

  """The categories/genres of the book"""
  categories: [String!]

  """The cover image URL of the book"""
  coverImageUrl: String

  """The description of the book"""
  description: String

  """The Google Books URL for the book (deprecated, use rakutenBooksUrl)"""
  googleBooksUrl: String @deprecated(reason: "Use rakutenBooksUrl instead")

  """The unique identifier of the book"""
  id: String!

  """The ISBN of the book"""
  isbn: String

  """The number of pages in the book"""
  pageCount: Int

  """The publication date of the book"""
  publishedDate: String

  """The publisher of the book"""
  publisher: String

  """The Rakuten Books URL for the book"""
  rakutenBooksUrl: String

  """The title of the book"""
  title: String!

  """The user's reading record for this book (if added to shelf)"""
  userBook: UserBook
}

"""
A date-time string at UTC, such as 2007-12-03T10:15:30Z, compliant with the `date-time` format outlined in section 5.6 of the RFC 3339 profile of the ISO 8601 standard for representation of dates and times using the Gregorian calendar.
"""
scalar DateTime

"""Result of successful login"""
type LoginResult {
  """Firebase ID token for API authentication"""
  idToken: String!

  """Firebase refresh token for obtaining new ID tokens"""
  refreshToken: String!

  """Logged in user"""
  user: User!
}

"""Input for user login"""
input LoginUserInput {
  """Email address"""
  email: String!

  """Password"""
  password: String!
}

"""Result of me query - either User or AuthErrorResult"""
union MeResult = AuthErrorResult | User

type Mutation {
  """Add a book to the user's shelf"""
  addBookToShelf(bookInput: AddBookInput!): UserBook!

  """Login with email and password"""
  loginUser(input: LoginUserInput!): MutationLoginUserResult

  """Refresh ID token using refresh token"""
  refreshToken(input: RefreshTokenInput!): MutationRefreshTokenResult

  """Register a new user with email and password"""
  registerUser(input: RegisterUserInput!): MutationRegisterUserResult

  """Remove a book from the user's shelf"""
  removeFromShelf(userBookId: Int!): Boolean!

  """Update the current user's profile"""
  updateProfile(input: UpdateProfileInput!): MutationUpdateProfileResult

  """Update the reading note of a book in the user's shelf"""
  updateReadingNote(note: String!, userBookId: Int!): UserBook!

  """Update the reading status of a book in the user's shelf"""
  updateReadingStatus(status: ReadingStatus!, userBookId: Int!): UserBook!
}

union MutationLoginUserResult = AuthError | MutationLoginUserSuccess

type MutationLoginUserSuccess {
  data: LoginResult!
}

union MutationRefreshTokenResult = AuthError | MutationRefreshTokenSuccess

type MutationRefreshTokenSuccess {
  data: RefreshTokenResult!
}

union MutationRegisterUserResult = AuthError | MutationRegisterUserSuccess

type MutationRegisterUserSuccess {
  data: User!
}

union MutationUpdateProfileResult = MutationUpdateProfileSuccess | ValidationError

type MutationUpdateProfileSuccess {
  data: User!
}

type Query {
  """Get detailed information about a book by ID"""
  bookDetail(bookId: String!): BookDetail!
  health: String

  """Get the currently authenticated user"""
  me: MeResult!

  """Get books in the user's shelf with pagination, sorting, and search"""
  myShelf(input: MyShelfInput): MyShelfResult!

  """Search for a book by ISBN"""
  searchBookByISBN(isbn: String!): Book

  """Search for books by keyword (matches title, author, etc.)"""
  searchBooks(limit: Int, offset: Int, query: String!): SearchBooksResult!

  """Get the user's reading record for a book by external ID"""
  userBookByExternalId(externalId: String!): UserBook
}

"""Reading status of a book in the user's shelf"""
enum ReadingStatus {
  """Unread (backlog)"""
  BACKLOG

  """Finished reading"""
  COMPLETED

  """Dropped/Not reading"""
  DROPPED

  """Currently reading"""
  READING
}

"""Sort field for books in shelf"""
enum ShelfSortField {
  """Sort by date added to shelf"""
  ADDED_AT
  """Sort by book title"""
  TITLE
  """Sort by author name"""
  AUTHOR
}

"""Sort order direction"""
enum SortOrder {
  """Ascending order"""
  ASC
  """Descending order"""
  DESC
}

"""Input for querying user's book shelf"""
input MyShelfInput {
  """Search query to filter books by title or author"""
  query: String
  """Field to sort by"""
  sortBy: String
  """Sort order direction"""
  sortOrder: String
  """Number of items to return (default: 20)"""
  limit: Int
  """Number of items to skip (default: 0)"""
  offset: Int
}

"""Result of user's book shelf query"""
type MyShelfResult {
  """List of books in the shelf"""
  items: [UserBook!]!
  """Total number of books matching the query"""
  totalCount: Int!
  """Whether there are more books to fetch"""
  hasMore: Boolean!
}

"""Input for token refresh"""
input RefreshTokenInput {
  """Refresh token"""
  refreshToken: String!
}

"""Result of successful token refresh"""
type RefreshTokenResult {
  """New Firebase ID token"""
  idToken: String!

  """New refresh token"""
  refreshToken: String!
}

"""Input for user registration"""
input RegisterUserInput {
  """Email address"""
  email: String!

  """Password"""
  password: String!
}

"""Search results containing a list of books"""
type SearchBooksResult {
  """Whether there are more books to fetch"""
  hasMore: Boolean!

  """The list of books found"""
  items: [Book!]!

  """The total number of books found"""
  totalCount: Int!
}

"""Input for updating user profile"""
input UpdateProfileInput {
  """User display name"""
  name: String!
}

"""A user in the system"""
type User {
  """The URL of the user's avatar image"""
  avatarUrl: String

  """The number of books in the user's shelf"""
  bookCount: Int!

  """When the user was created"""
  createdAt: DateTime

  """The email address of the user"""
  email: String

  """The unique identifier of the user"""
  id: Int

  """The display name of the user"""
  name: String

  """When the user was last updated"""
  updatedAt: DateTime
}

"""A book in the user's shelf"""
type UserBook {
  """When the book was added to the shelf"""
  addedAt: DateTime!

  """The authors of the book"""
  authors: [String!]!

  """When the book was marked as completed"""
  completedAt: DateTime

  """The cover image URL of the book"""
  coverImageUrl: String

  """The external ID of the book"""
  externalId: String!

  """The unique identifier of the user book"""
  id: Int!

  """The ISBN of the book"""
  isbn: String

  """User's reading note for the book"""
  note: String

  """When the note was last updated"""
  noteUpdatedAt: DateTime

  """The publication date of the book"""
  publishedDate: String

  """The publisher of the book"""
  publisher: String

  """The reading status of the book"""
  readingStatus: ReadingStatus!

  """The title of the book"""
  title: String!
}

"""Validation error for user input"""
type ValidationError {
  """Error code"""
  code: String

  """Field that caused the error, if applicable"""
  field: String

  """Human-readable error message"""
  message: String
}